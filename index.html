<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lightning Dice Tracker - AI Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 25px 75px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 40px;
            text-align: center;
            border-bottom: 4px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.95;
            font-weight: 300;
        }

        .ai-badge {
            display: inline-block;
            background: linear-gradient(135deg, #00c9ff 0%, #92fe9d 100%);
            color: #000;
            padding: 6px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(0, 201, 255, 0.3);
        }

        .status-bar {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 18px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #dee2e6;
            font-weight: 600;
            flex-wrap: wrap;
            gap: 15px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.05rem;
        }

        .status-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .prediction-banner {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 100%);
            color: white;
            padding: 25px 40px;
            margin: 20px 40px;
            border-radius: 18px;
            display: none;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            border: 3px solid rgba(255, 255, 255, 0.15);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .prediction-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #00c9ff, #92fe9d);
        }

        .prediction-banner.show {
            display: block;
            animation: slideIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .banner-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .banner-left h3 {
            margin: 0;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 8px;
        }

        .banner-left p {
            margin: 0;
            opacity: 0.9;
            font-size: 1.05rem;
            line-height: 1.5;
        }

        .banner-right {
            text-align: right;
            min-width: 180px;
        }

        .confidence-badge {
            font-size: 2.8rem;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 30px;
            border-radius: 15px;
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .confidence-label {
            font-size: 1rem;
            opacity: 0.85;
            margin-top: 8px;
            font-weight: 500;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            padding: 40px;
        }

        @media (max-width: 1400px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: white;
            border-radius: 18px;
            padding: 30px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid #e9ecef;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
        }

        .panel-title {
            font-size: 1.8rem;
            color: #495057;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 700;
        }

        .panel-title i {
            color: #667eea;
            font-size: 1.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid #dee2e6;
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
        }

        .stat-value {
            font-size: 2.8rem;
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }

        .stat-label {
            font-size: 1rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 600;
        }

        /* Accordion Styles for Distribution */
        .accordion {
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #e9ecef;
        }

        .accordion-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px 25px;
            font-size: 1.2rem;
            font-weight: 700;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .accordion-header:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a5fa8 100%);
        }

        .accordion-header i {
            transition: transform 0.3s ease;
        }

        .accordion-header.active i {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, padding 0.3s ease;
            background: #f8f9fa;
        }

        .accordion-content.open {
            max-height: 500px;
            padding: 20px;
        }

        .distribution-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .distribution-list::-webkit-scrollbar {
            width: 6px;
        }

        .distribution-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .distribution-list::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .distribution-list::-webkit-scrollbar-thumb:hover {
            background: #5a6fd8;
        }

        .distribution-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            transition: all 0.2s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .distribution-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .distribution-total {
            font-weight: 600;
            color: #495057;
            font-size: 1.1rem;
        }

        .distribution-count {
            font-weight: 700;
            color: #667eea;
            font-size: 1.2rem;
            background: #667eea10;
            padding: 5px 15px;
            border-radius: 20px;
        }

        .prediction-display {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 18px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid #90caf9;
            position: relative;
            overflow: hidden;
        }

        .prediction-display::before {
            content: 'ü§ñ';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 4rem;
            opacity: 0.1;
        }

        .prediction-main {
            font-size: 3.5rem;
            font-weight: bold;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .prediction-icon {
            font-size: 4rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .prediction-confidence {
            font-size: 2.2rem;
            color: #1976d2;
            margin: 15px 0;
            font-weight: 700;
        }

        .prediction-reason {
            color: #555;
            font-size: 1.05rem;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            line-height: 1.6;
            border-left: 4px solid #1976d2;
        }

        .probability-bars {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            gap: 15px;
        }

        .probability-bar {
            flex: 1;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .probability-bar:hover {
            transform: scale(1.05);
        }

        .bar-container {
            height: 150px;
            background: #f0f0f0;
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .bar-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            transition: height 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 12px;
        }

        .bar-label {
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 1.2rem;
            color: #495057;
        }

        .bar-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        .low-bar .bar-fill { 
            background: linear-gradient(to top, #28a745, #43e97b);
            box-shadow: 0 5px 20px rgba(40, 167, 69, 0.3);
        }
        .middle-bar .bar-fill { 
            background: linear-gradient(to top, #ffc107, #ffde59);
            box-shadow: 0 5px 20px rgba(255, 193, 7, 0.3);
        }
        .high-bar .bar-fill { 
            background: linear-gradient(to top, #dc3545, #ff6b6b);
            box-shadow: 0 5px 20px rgba(220, 53, 69, 0.3);
        }

        .latest-game {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 18px;
            margin-bottom: 30px;
            border: 3px solid #90caf9;
            position: relative;
        }

        .latest-game::after {
            content: 'NEW';
            position: absolute;
            top: 15px;
            right: 15px;
            background: #dc3545;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .game-title {
            font-size: 1.6rem;
            color: #1976d2;
            font-weight: 700;
        }

        .game-time {
            font-size: 1.1rem;
            color: #666;
            background: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .dice-display {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 25px 0;
        }

        .dice {
            font-size: 5rem;
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .dice:hover {
            transform: rotate(15deg) scale(1.1);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .total-display {
            text-align: center;
            margin: 30px 0;
        }

        .total-label {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .total-value {
            font-size: 4.5rem;
            font-weight: bold;
            color: #1976d2;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.15);
            margin: 15px 0;
        }

        .games-table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 700;
            font-size: 1.1rem;
            position: sticky;
            top: 0;
            border-bottom: 3px solid #5a6fd8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        th:first-child {
            border-radius: 15px 0 0 0;
        }

        th:last-child {
            border-radius: 0 15px 0 0;
        }

        td {
            padding: 18px 15px;
            border-bottom: 2px solid #f0f0f0;
            font-size: 1.05rem;
        }

        tr:hover {
            background: linear-gradient(135deg, #667eea05 0%, #764ba205 100%);
            transform: scale(1.002);
            transition: transform 0.2s ease;
        }

        tr.correct-prediction {
            background: linear-gradient(135deg, #d4edda15 0%, #c3e6cb15 100%);
            border-left: 5px solid #28a745;
        }

        tr.incorrect-prediction {
            background: linear-gradient(135deg, #f8d7da15 0%, #f5c6cb15 100%);
            border-left: 5px solid #dc3545;
        }

        .controls {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            min-width: 180px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(3px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a5fa8 100%);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #5a6268 0%, #343a40 100%);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(108, 117, 125, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #218838 0%, #1ea084 100%);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #ffd54f 100%);
            color: #212529;
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, #e0a800 0%, #ffca28 100%);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 193, 7, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #c82333 0%, #d63384 100%);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(220, 53, 69, 0.4);
        }

        .refresh-info {
            margin-top: 20px;
            color: #6c757d;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #6c757d;
            font-size: 1.3rem;
            font-weight: 500;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            color: #721c24;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid #f5c6cb;
            text-align: center;
            font-weight: 600;
        }

        .success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid #c3e6cb;
            text-align: center;
            font-weight: 600;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .badge-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .badge-warning {
            background: linear-gradient(135deg, #ffc107 0%, #ffd54f 100%);
            color: #212529;
        }

        .badge-danger {
            background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
            color: white;
        }

        .ai-status {
            display: inline-block;
            padding: 6px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 700;
            margin-left: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .status-learning { 
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
            border: 2px solid #ffeaa7;
        }
        .status-active { 
            background: linear-gradient(135deg, #d4edda 0%, #a8e6cf 100%);
            color: #155724;
            border: 2px solid #a8e6cf;
        }
        .status-error { 
            background: linear-gradient(135deg, #f8d7da 0%, #ffaaa5 100%);
            color: #721c24;
            border: 2px solid #ffaaa5;
        }

        .ai-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .ai-stat-card {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #667eea30;
            transition: all 0.3s ease;
        }

        .ai-stat-card:hover {
            transform: translateY(-5px);
            border-color: #667eea60;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
        }

        .ai-stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }

        .ai-stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .prediction-accuracy {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            border: 2px solid #dee2e6;
        }

        .accuracy-bar {
            height: 15px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .accuracy-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #dc3545 100%);
            transition: width 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(40, 167, 69, 0.3);
        }

        .pagination-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .page-info {
            font-size: 1.1rem;
            font-weight: 600;
            color: #495057;
            min-width: 200px;
            text-align: center;
        }

        .page-btn {
            padding: 12px 25px;
            font-size: 1rem;
            min-width: auto;
            border-radius: 10px;
        }

        .results-per-page {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: #495057;
        }

        .results-select {
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #667eea;
            background: white;
            color: #495057;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .results-select:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
        }

        .view-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-btn {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            color: #495057;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .view-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .game-accuracy {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 700;
            margin-left: 10px;
        }

        .accuracy-correct {
            background: #28a74520;
            color: #28a745;
            border: 1px solid #28a745;
        }

        .accuracy-incorrect {
            background: #dc354520;
            color: #dc3545;
            border: 1px solid #dc3545;
        }

        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            border: 3px solid white;
            z-index: 1000;
            transition: all 0.3s ease;
            display: none;
        }

        .scroll-to-top:hover {
            transform: translateY(-10px) scale(1.1);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .timestamp-cell {
            min-width: 150px;
        }

        .dice-cell {
            min-width: 120px;
        }

        .total-cell {
            min-width: 100px;
        }

        .prediction-cell {
            min-width: 120px;
        }

        .accuracy-cell {
            min-width: 100px;
        }

        .details-cell {
            min-width: 200px;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .performance-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #dee2e6;
        }

        .performance-value {
            font-size: 2rem;
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }

        .performance-label {
            font-size: 0.9rem;
            color: #6c757d;
            font-weight: 600;
        }

        .streak-indicator {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin: 0 5px;
        }

        .streak-hot {
            background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
            color: white;
        }

        .streak-warm {
            background: linear-gradient(135deg, #ffc107 0%, #ffd54f 100%);
            color: #212529;
        }

        .streak-cool {
            background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
            color: white;
        }

        /* New styles for prediction table */
        .prediction-result {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: bold;
        }

        .result-correct {
            color: #28a745;
            background: rgba(40, 167, 69, 0.1);
            padding: 4px 12px;
            border-radius: 15px;
            border: 1px solid #28a745;
        }

        .result-incorrect {
            color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
            padding: 4px 12px;
            border-radius: 15px;
            border: 1px solid #dc3545;
        }

        .result-pending {
            color: #ffc107;
            background: rgba(255, 193, 7, 0.1);
            padding: 4px 12px;
            border-radius: 15px;
            border: 1px solid #ffc107;
        }

        .confidence-indicator {
            display: inline-block;
            width: 60px;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin: 0 5px;
        }

        .confidence-fill {
            height: 100%;
            border-radius: 3px;
        }

        .confidence-high {
            background: linear-gradient(90deg, #28a745, #20c997);
        }

        .confidence-medium {
            background: linear-gradient(90deg, #ffc107, #ffd54f);
        }

        .confidence-low {
            background: linear-gradient(90deg, #dc3545, #e83e8c);
        }

        .category-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin: 2px;
        }

        .category-low {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .category-middle {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .category-high {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* New styles for prediction stats */
        .prediction-stats-container {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-left: auto;
            padding: 8px 16px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            border: 2px solid #dee2e6;
        }

        .prediction-stat {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            white-space: nowrap;
        }

        .prediction-stat-icon {
            font-size: 1.2rem;
        }

        .prediction-stat-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .prediction-stat-total {
            color: #667eea;
        }

        .prediction-stat-correct {
            color: #28a745;
        }

        .prediction-stat-incorrect {
            color: #dc3545;
        }

        .prediction-stat-accuracy {
            color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé≤ Lightning Dice Tracker ü§ñ</h1>
            <p>Real-time tracking with Advanced AI Prediction System</p>
            <div class="ai-badge">‚ö° 72-Hour Data Analysis | üß† Self-Learning AI | üìä Real Predictions</div>
        </div>

        <div class="prediction-banner" id="prediction-banner">
            <div class="banner-content">
                <div class="banner-left">
                    <h3>ü§ñ AI LIVE PREDICTION</h3>
                    <p id="prediction-text">Analyzing patterns for next game...</p>
                    <div id="prediction-reason" style="font-size: 0.95rem; opacity: 0.85; margin-top: 10px;"></div>
                </div>
                <div class="banner-right">
                    <div class="confidence-badge" id="prediction-confidence">--%</div>
                    <div class="confidence-label">Confidence Level</div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <div class="status-dot" id="connection-dot"></div>
                <span id="connection-status">Connected to API</span>
            </div>
            <div class="status-item">
                <span>üìä Total Games: </span>
                <span id="total-games" style="color: #667eea; font-weight: 700;">0</span>
            </div>
            <div class="status-item">
                <span>üïí Last Update: </span>
                <span id="last-update" style="color: #28a745; font-weight: 700;">--:--:--</span>
            </div>
            <div class="status-item">
                <span>üéØ Next Check: </span>
                <span id="next-check" style="color: #dc3545; font-weight: 700;">3s</span>
            </div>
            <div class="status-item">
                <span>ü§ñ AI Status: </span>
                <span id="ai-status-text" class="ai-status status-learning">Initializing</span>
            </div>
        </div>

        <div class="dashboard">
            <!-- Left Panel: Stats & AI Prediction -->
            <div>
                <div class="panel">
                    <h2 class="panel-title">üìä SYSTEM STATISTICS</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="stats-total">0</div>
                            <div class="stat-label">Total Games</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="stats-avg">0.00</div>
                            <div class="stat-label">Average Total</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="stats-min">3</div>
                            <div class="stat-label">Minimum</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="stats-max">18</div>
                            <div class="stat-label">Maximum</div>
                        </div>
                    </div>

                    <!-- Accordion for Distribution -->
                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion('distribution-accordion')">
                            <span>üìà TOTAL DISTRIBUTION (Click to Expand)</span>
                            <i>‚ñº</i>
                        </div>
                        <div class="accordion-content" id="distribution-accordion">
                            <div id="distribution-list" class="distribution-list">
                                <div class="loading">Loading distribution...</div>
                            </div>
                        </div>
                    </div>

                    <div class="controls">
                        <button class="btn-primary" onclick="loadStats()">
                            üîÑ Refresh Stats
                        </button>
                        <button class="btn-success" onclick="forceRefresh()">
                            ‚ö° Force Update
                        </button>
                        <button class="btn-warning" onclick="clearFilters()">
                            üßπ Clear Filters
                        </button>
                    </div>
                </div>

                <div class="panel" style="margin-top: 20px;">
                    <h2 class="panel-title">ü§ñ AI PREDICTION SYSTEM</h2>
                    
                    <!-- ‚úÖ ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡ß®‡¶ü‡¶ø ‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø‡¶ï‡ßç‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá -->
                    <div class="ai-stats-grid">
                        <div class="ai-stat-card">
                            <div class="ai-stat-value" id="ai-accuracy">0%</div>
                            <div class="ai-stat-label">Overall Accuracy</div>
                        </div>
                        <div class="ai-stat-card">
                            <div class="ai-stat-value" id="ai-total">0</div>
                            <div class="ai-stat-label">Games Analyzed</div>
                        </div>
                    </div>

                    <div class="prediction-display">
                        <h3 style="color: #495057; margin-bottom: 20px; font-size: 1.5rem;">üéØ NEXT GAME PREDICTION</h3>
                        <div id="next-prediction">
                            <div class="loading">AI analyzing patterns...</div>
                        </div>
                    </div>

                    <div class="probability-bars">
                        <div class="probability-bar low-bar">
                            <div class="bar-label">LOW (3-9)</div>
                            <div class="bar-container">
                                <div class="bar-fill" id="low-bar" style="height: 0%"></div>
                            </div>
                            <div class="bar-value" id="low-value">0%</div>
                        </div>
                        <div class="probability-bar middle-bar">
                            <div class="bar-label">MIDDLE (10-11)</div>
                            <div class="bar-container">
                                <div class="bar-fill" id="middle-bar" style="height: 0%"></div>
                            </div>
                            <div class="bar-value" id="middle-value">0%</div>
                        </div>
                        <div class="probability-bar high-bar">
                            <div class="bar-label">HIGH (12-18)</div>
                            <div class="bar-container">
                                <div class="bar-fill" id="high-bar" style="height: 0%"></div>
                            </div>
                            <div class="bar-value" id="high-value">0%</div>
                        </div>
                    </div>

                    <div class="prediction-accuracy">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 1.1rem;">
                            <span style="font-weight: 600;">üéØ Prediction Accuracy:</span>
                            <span id="overall-accuracy" style="font-weight: 700; color: #667eea;">0%</span>
                        </div>
                        <div class="accuracy-bar">
                            <div class="accuracy-fill" id="accuracy-fill" style="width: 0%"></div>
                        </div>
                        <div style="font-size: 0.9rem; color: #666; text-align: center; margin-top: 10px; font-weight: 500;">
                            Target Accuracy: 80% | Current: <span id="current-accuracy">0%</span>
                        </div>
                    </div>

                    <div class="controls">
                        <button class="btn-primary" onclick="getAIPrediction()">
                            üß† Get AI Prediction
                        </button>
                        <button class="btn-warning" onclick="loadGamesWithPredictions()">
                            üìä Load Predictions
                        </button>
                        <button class="btn-danger" onclick="resetAIData()">
                            üîÑ Reset AI
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Games & Latest -->
            <div class="panel">
                <div class="view-options">
                    <button class="view-btn active" onclick="setViewMode('predictions')">ü§ñ AI Predictions</button>
                    <button class="view-btn" onclick="setViewMode('all')">üìã All Games</button>
                    <button class="view-btn" onclick="setViewMode('performance')">üìà Performance</button>
                </div>

                <h2 class="panel-title">üéØ LATEST GAME</h2>
                
                <div class="latest-game" id="latest-game">
                    <div class="loading">Loading latest game...</div>
                </div>

                <div id="performance-section" style="display: none;">
                    <h2 class="panel-title">üìä PERFORMANCE ANALYTICS</h2>
                    <div class="performance-grid" id="performance-grid">
                        <div class="performance-card">
                            <div class="performance-value" id="perf-last10">0%</div>
                            <div class="performance-label">Last 10 Games</div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-value" id="perf-last50">0%</div>
                            <div class="performance-label">Last 50 Games</div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-value" id="perf-streak">0</div>
                            <div class="performance-label">Current Streak</div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-value" id="perf-best">0</div>
                            <div class="performance-label">Best Streak</div>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">Category Accuracy:</div>
                        <div style="display: flex; gap: 20px; justify-content: center;">
                            <div>
                                <div style="font-size: 1.2rem; font-weight: bold; color: #28a745;" id="cat-low">0%</div>
                                <div style="font-size: 0.8rem; color: #6c757d;">LOW</div>
                            </div>
                            <div>
                                <div style="font-size: 1.2rem; font-weight: bold; color: #ffc107;" id="cat-middle">0%</div>
                                <div style="font-size: 0.8rem; color: #6c757d;">MIDDLE</div>
                            </div>
                            <div>
                                <div style="font-size: 1.2rem; font-weight: bold; color: #dc3545;" id="cat-high">0%</div>
                                <div style="font-size: 0.8rem; color: #6c757d;">HIGH</div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2 class="panel-title">ü§ñ AI PREDICTION HISTORY</h2>
                
                <div class="results-per-page">
                    <span>Show:</span>
                    <select class="results-select" id="per-page-select" onchange="changePerPage()">
                        <option value="10">10 games</option>
                        <option value="20">20 games</option>
                        <option value="50" selected>50 games</option>
                        <option value="100">100 games</option>
                    </select>
                    <span id="total-results">0 games</span>
                    
                    <!-- ‚úÖ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ -->
                    <div class="prediction-stats-container" id="prediction-stats-container">
                        <div class="prediction-stat">
                            <span class="prediction-stat-icon">ü§ñ</span>
                            <span class="prediction-stat-label">Predictions:</span>
                            <span class="prediction-stat-value prediction-stat-total" id="total-predictions">0</span>
                        </div>
                        <div class="prediction-stat">
                            <span class="prediction-stat-icon">‚úÖ</span>
                            <span class="prediction-stat-label">Correct:</span>
                            <span class="prediction-stat-value prediction-stat-correct" id="correct-predictions">0</span>
                        </div>
                        <div class="prediction-stat">
                            <span class="prediction-stat-icon">‚ùå</span>
                            <span class="prediction-stat-label">Incorrect:</span>
                            <span class="prediction-stat-value prediction-stat-incorrect" id="incorrect-predictions">0</span>
                        </div>
                        <div class="prediction-stat">
                            <span class="prediction-stat-icon">üìä</span>
                            <span class="prediction-stat-label">Accuracy:</span>
                            <span class="prediction-stat-value prediction-stat-accuracy" id="prediction-accuracy">0%</span>
                        </div>
                    </div>
                </div>
                
                <div class="games-table-container">
                    <div id="games-table">
                        <div class="loading">Loading AI prediction history...</div>
                    </div>
                </div>

                <div class="pagination-controls">
                    <button class="page-btn btn-secondary" onclick="prevPage()" id="prev-btn">
                        ‚¨ÖÔ∏è Previous
                    </button>
                    <div class="page-info">
                        Page <span id="current-page">1</span> of <span id="total-pages">1</span>
                        | Showing <span id="showing-start">0</span>-<span id="showing-end">0</span> of <span id="total-games-count">0</span>
                    </div>
                    <button class="page-btn btn-secondary" onclick="nextPage()" id="next-btn">
                        Next ‚û°Ô∏è
                    </button>
                </div>

                <div class="controls">
                    <button class="btn-secondary" onclick="loadFirstPage()">
                        ‚èÆÔ∏è First Page
                    </button>
                    <button class="btn-primary" onclick="quickCheck()">
                        üîç Check New
                    </button>
                    <button class="btn-success" onclick="loadGamesWithPredictions()">
                        üîÑ Refresh AI Data
                    </button>
                </div>

                <div class="refresh-info">
                    ‚ö° Showing games with AI predictions | üéØ Real-time accuracy tracking | ü§ñ Self-learning AI
                </div>
            </div>
        </div>
    </div>

    <div class="scroll-to-top" id="scroll-to-top" onclick="scrollToTop()">
        ‚Üë
    </div>

    <script>
        // Global variables
        let currentPage = 1;
        let gamesPerPage = 50;
        let totalGames = 0;
        let totalPages = 1;
        let viewMode = 'predictions'; // Default to predictions view
        let autoRefreshInterval;
        let aiStatsInterval;

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadStatus();
            loadStats();
            loadLatestGame();
            loadAIStats(); // ‚úÖ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã AI stats ‡¶≤‡ßã‡¶°
            
            // Load prediction table by default
            loadGamesWithPredictions();
            
            // Start auto refresh
            autoRefreshInterval = setInterval(autoRefresh, 3000);
            
            // Start AI stats auto refresh (every 10 seconds)
            aiStatsInterval = setInterval(loadAIStats, 10000);
            
            // Load AI prediction after 3 seconds
            setTimeout(getAIPrediction, 3000);
            
            // Setup scroll to top button
            window.addEventListener('scroll', toggleScrollTopButton);
            
            // Setup view mode buttons
            setupViewModeButtons();
            
            // Initialize accordion
            initializeAccordion();
            
            // Initialize performance section
            loadPerformanceStats();
            
            console.log("Dashboard initialized with AI Prediction History table");
        });

        // Initialize accordion functionality
        function initializeAccordion() {
            // Set default state (closed)
            const accordionContent = document.getElementById('distribution-accordion');
            accordionContent.style.maxHeight = '0';
            accordionContent.style.padding = '0';
        }

        // Toggle accordion
        function toggleAccordion(accordionId) {
            const accordionHeader = document.querySelector(`#${accordionId}`).previousElementSibling;
            const accordionContent = document.getElementById(accordionId);
            
            accordionHeader.classList.toggle('active');
            
            if (accordionContent.classList.contains('open')) {
                accordionContent.classList.remove('open');
                accordionContent.style.maxHeight = '0';
                accordionContent.style.padding = '0';
            } else {
                accordionContent.classList.add('open');
                accordionContent.style.maxHeight = '500px';
                accordionContent.style.padding = '20px';
                
                // Load distribution data if not already loaded
                if (document.getElementById('distribution-list').querySelector('.loading')) {
                    loadStats();
                }
            }
        }

        // Setup view mode buttons
        function setupViewModeButtons() {
            const buttons = document.querySelectorAll('.view-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    buttons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        // Set view mode
        function setViewMode(mode) {
            viewMode = mode;
            currentPage = 1;
            
            // Show/hide sections
            const performanceSection = document.getElementById('performance-section');
            const gamesTitle = document.querySelector('.panel-title:nth-child(4)');
            
            if (mode === 'performance') {
                performanceSection.style.display = 'block';
                gamesTitle.style.display = 'none';
                document.querySelector('.panel-title:nth-child(5)').style.display = 'none';
                loadPerformanceStats();
            } else {
                performanceSection.style.display = 'none';
                gamesTitle.style.display = 'block';
                document.querySelector('.panel-title:nth-child(5)').style.display = 'block';
                
                if (mode === 'predictions') {
                    document.querySelector('.panel-title:nth-child(5)').textContent = 'ü§ñ AI PREDICTION HISTORY';
                    loadGamesWithPredictions();
                } else {
                    document.querySelector('.panel-title:nth-child(5)').textContent = 'üìã ALL GAMES HISTORY';
                    loadAllGames();
                }
            }
            
            let modeText = '';
            switch(mode) {
                case 'all': modeText = 'All Games'; break;
                case 'predictions': modeText = 'AI Predictions'; break;
                case 'performance': modeText = 'Performance Analytics'; break;
            }
            
            showNotification(`Viewing: ${modeText}`);
        }

        // Load performance statistics
        async function loadPerformanceStats() {
            try {
                console.log('Loading performance stats...');
                
                // Show loading state
                const performanceGrid = document.getElementById('performance-grid');
                performanceGrid.innerHTML = `
                    <div class="performance-card">
                        <div class="loading">Loading...</div>
                    </div>
                    <div class="performance-card">
                        <div class="loading">Loading...</div>
                    </div>
                    <div class="performance-card">
                        <div class="loading">Loading...</div>
                    </div>
                    <div class="performance-card">
                        <div class="loading">Loading...</div>
                    </div>
                `;
                
                // Get AI stats
                const aiResponse = await fetch('/api/prediction-stats');
                const aiData = await aiResponse.json();
                
                if (aiData.success) {
                    // Update category accuracy from AI stats
                    if (aiData.stats && aiData.stats.category_accuracy) {
                        document.getElementById('cat-low').textContent = `${aiData.stats.category_accuracy.LOW || 0}%`;
                        document.getElementById('cat-middle').textContent = `${aiData.stats.category_accuracy.MIDDLE || 0}%`;
                        document.getElementById('cat-high').textContent = `${aiData.stats.category_accuracy.HIGH || 0}%`;
                    }
                }
                
                // Then get performance data
                const response = await fetch('/api/prediction-performance');
                const data = await response.json();
                
                console.log('Performance API response:', data);
                
                if (data.success && data.performance) {
                    const perf = data.performance;
                    
                    // Update performance cards with actual data
                    const last10Accuracy = perf.last_10?.accuracy ?? 0;
                    const last50Accuracy = perf.last_50?.accuracy ?? 0;
                    
                    document.getElementById('perf-last10').textContent = `${last10Accuracy.toFixed(1)}%`;
                    document.getElementById('perf-last50').textContent = `${last50Accuracy.toFixed(1)}%`;
                    document.getElementById('perf-streak').textContent = perf.current_streak || 0;
                    document.getElementById('perf-best').textContent = perf.longest_streak || 0;
                    
                    // Update category accuracy from performance data if available
                    if (perf.category_accuracy) {
                        document.getElementById('cat-low').textContent = `${perf.category_accuracy.LOW || 0}%`;
                        document.getElementById('cat-middle').textContent = `${perf.category_accuracy.MIDDLE || 0}%`;
                        document.getElementById('cat-high').textContent = `${perf.category_accuracy.HIGH || 0}%`;
                    }
                    
                    console.log('Performance stats updated successfully');
                } else {
                    // If no performance data, use AI stats
                    if (aiData.success) {
                        document.getElementById('perf-last10').textContent = `${(aiData.stats.recent_accuracy || 0).toFixed(1)}%`;
                        document.getElementById('perf-last50').textContent = `${(aiData.stats.accuracy_percentage || 0).toFixed(1)}%`;
                        document.getElementById('perf-streak').textContent = '0';
                        document.getElementById('perf-best').textContent = '0';
                        
                        console.log('Using AI stats as fallback');
                    }
                }
            } catch (error) {
                console.error('Error loading performance stats:', error);
                
                // Set default values on error
                document.getElementById('perf-last10').textContent = '0%';
                document.getElementById('perf-last50').textContent = '0%';
                document.getElementById('perf-streak').textContent = '0';
                document.getElementById('perf-best').textContent = '0';
                document.getElementById('cat-low').textContent = '0%';
                document.getElementById('cat-middle').textContent = '0%';
                document.getElementById('cat-high').textContent = '0%';
                
                showNotification('Error loading performance data', 'error');
            }
        }

        // Change results per page
        function changePerPage() {
            const select = document.getElementById('per-page-select');
            gamesPerPage = parseInt(select.value);
            currentPage = 1;
            
            if (viewMode === 'predictions') {
                loadGamesWithPredictions();
            } else {
                loadAllGames();
            }
            
            showNotification(`Now showing ${gamesPerPage} games per page`);
        }

        // Auto refresh function
        function autoRefresh() {
            loadStatus();
            quickCheck();
            
            // Update next check counter
            let nextCheck = document.getElementById('next-check');
            nextCheck.textContent = 'Now';
            nextCheck.style.color = '#28a745';
            
            // Reset counter after 1 second
            setTimeout(() => {
                let count = 3;
                const countdown = setInterval(() => {
                    nextCheck.textContent = count + 's';
                    nextCheck.style.color = count <= 2 ? '#dc3545' : '#ffc107';
                    count--;
                    if (count < 0) {
                        clearInterval(countdown);
                    }
                }, 1000);
            }, 1000);
        }

        // Load system status
        async function loadStatus() {
            try {
                const response = await fetch('/api/status');
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('connection-status').textContent = 'Connected to API';
                    document.getElementById('last-update').textContent = data.last_update || '--:--:--';
                    document.getElementById('total-games').textContent = data.total_games.toLocaleString();
                    
                    // Update status dot color
                    const statusDot = document.getElementById('connection-dot');
                    if (data.connection_status === 'online') {
                        statusDot.style.background = '#28a745';
                        statusDot.style.boxShadow = '0 0 15px rgba(40, 167, 69, 0.7)';
                    } else {
                        statusDot.style.background = '#dc3545';
                        statusDot.style.boxShadow = '0 0 15px rgba(220, 53, 69, 0.7)';
                    }
                    
                    // Update AI status
                    if (data.ai_status) {
                        document.getElementById('ai-status-text').textContent = data.ai_status;
                        document.getElementById('ai-status-text').className = `ai-status status-${data.ai_status}`;
                    }
                }
            } catch (error) {
                console.error('Error loading status:', error);
                document.getElementById('connection-status').textContent = 'Disconnected';
                document.getElementById('connection-dot').style.background = '#dc3545';
                document.getElementById('connection-dot').style.boxShadow = '0 0 15px rgba(220, 53, 69, 0.7)';
            }
        }

        // Load statistics
        async function loadStats() {
            try {
                const response = await fetch('/api/get-stats');
                const data = await response.json();
                
                if (data.success) {
                    // Update stat cards
                    document.getElementById('stats-total').textContent = data.stats.total_games.toLocaleString();
                    document.getElementById('stats-avg').textContent = data.stats.avg_total || '0.00';
                    document.getElementById('stats-min').textContent = data.stats.min_total || '3';
                    document.getElementById('stats-max').textContent = data.stats.max_total || '18';
                    
                    // Update distribution list
                    const distributionList = document.getElementById('distribution-list');
                    distributionList.innerHTML = '';
                    
                    if (data.distribution && Object.keys(data.distribution).length > 0) {
                        Object.entries(data.distribution).forEach(([total, count]) => {
                            const item = document.createElement('div');
                            item.className = 'distribution-item';
                            
                            // Calculate percentage
                            const totalGames = data.stats.total_games;
                            const percentage = totalGames > 0 ? ((count / totalGames) * 100).toFixed(1) : 0;
                            
                            item.innerHTML = `
                                <div>
                                    <span class="distribution-total">üé≤ Total ${total}</span>
                                    <div style="font-size: 0.9rem; color: #6c757d; margin-top: 2px;">
                                        ${percentage}% of total
                                    </div>
                                </div>
                                <span class="distribution-count">${count.toLocaleString()} games</span>
                            `;
                            distributionList.appendChild(item);
                        });
                    } else {
                        distributionList.innerHTML = '<div class="error">No distribution data available</div>';
                    }
                }
            } catch (error) {
                console.error('Error loading stats:', error);
                document.getElementById('distribution-list').innerHTML = 
                    '<div class="error">Error loading distribution data</div>';
            }
        }

        // ‚úÖ UPDATED: AI statistics ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
        async function loadAIStats() {
            try {
                const response = await fetch('/api/prediction-stats');
                const data = await response.json();
                
                if (data.success) {
                    updateAIStats(data.stats);
                    
                    // Update AI status
                    const aiStatus = document.getElementById('ai-status-text');
                    aiStatus.textContent = data.stats.system_status;
                    aiStatus.className = `ai-status status-${data.stats.system_status}`;
                    
                    // ‚úÖ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                    updateTableStats(data.stats);
                    
                    // Auto-load prediction if system is active
                    if (data.stats.system_status === 'active' && data.stats.total_games_analyzed > 50) {
                        getAIPrediction();
                    }
                }
            } catch (error) {
                console.error('Error loading AI stats:', error);
            }
        }

        // ‚úÖ UPDATED: AI stats update function
        function updateAIStats(stats) {
            // ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡ß®‡¶ü‡¶ø ‡¶Æ‡ßá‡¶ü‡ßç‡¶∞‡¶ø‡¶ï‡ßç‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá
            document.getElementById('ai-accuracy').textContent = `${stats.accuracy_percentage || 0}%`;
            document.getElementById('ai-total').textContent = (stats.total_games_analyzed || 0).toLocaleString();
            
            // Accuracy ‡¶¨‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            const accuracy = stats.accuracy_percentage || 0;
            document.getElementById('overall-accuracy').textContent = `${accuracy}%`;
            document.getElementById('current-accuracy').textContent = `${accuracy}%`;
            document.getElementById('accuracy-fill').style.width = `${Math.min(accuracy, 100)}%`;
            
            // Color code accuracy
            const accuracyFill = document.getElementById('accuracy-fill');
            if (accuracy >= 70) {
                accuracyFill.style.background = 'linear-gradient(90deg, #28a745 0%, #20c997 100%)';
            } else if (accuracy >= 50) {
                accuracyFill.style.background = 'linear-gradient(90deg, #ffc107 0%, #ffd54f 100%)';
            } else {
                accuracyFill.style.background = 'linear-gradient(90deg, #dc3545 0%, #e83e8c 100%)';
            }
        }

        // ‚úÖ NEW: ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        function updateTableStats(stats) {
            // ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
            const totalPredictions = stats.total_predictions || 0;
            const correctPredictions = stats.correct_predictions || 0;
            const incorrectPredictions = totalPredictions - correctPredictions;
            const accuracy = totalPredictions > 0 ? (correctPredictions / totalPredictions * 100) : 0;
            
            document.getElementById('total-predictions').textContent = totalPredictions;
            document.getElementById('correct-predictions').textContent = correctPredictions;
            document.getElementById('incorrect-predictions').textContent = incorrectPredictions;
            document.getElementById('prediction-accuracy').textContent = `${accuracy.toFixed(1)}%`;
            
            // Accuracy color code
            const accuracyElement = document.getElementById('prediction-accuracy');
            if (accuracy >= 70) {
                accuracyElement.style.color = '#28a745';
            } else if (accuracy >= 50) {
                accuracyElement.style.color = '#ffc107';
            } else {
                accuracyElement.style.color = '#dc3545';
            }
        }

        // Get AI prediction
        async function getAIPrediction() {
            try {
                const response = await fetch('/api/predict-next');
                const data = await response.json();
                
                if (data.success) {
                    displayPrediction(data.prediction);
                    updateProbabilityBars(data.prediction.probabilities);
                    
                    // Show banner with animation
                    const banner = document.getElementById('prediction-banner');
                    banner.classList.add('show');
                    
                    // Update AI stats if provided
                    if (data.stats) {
                        updateAIStats(data.stats);
                        updateTableStats(data.stats);
                    }
                    
                    // Store prediction for tracking
                    if (data.prediction && data.prediction.prediction_id) {
                        console.log('New prediction:', data.prediction);
                    }
                }
            } catch (error) {
                console.error('Error getting AI prediction:', error);
                showNotification('Error getting AI prediction', 'error');
            }
        }

        function displayPrediction(prediction) {
            // Update banner
            document.getElementById('prediction-text').innerHTML = `
                Next Game Prediction: <strong style="font-size: 1.2em;">${prediction.prediction}</strong>
            `;
            document.getElementById('prediction-reason').textContent = prediction.reason || 'Analyzing patterns...';
            document.getElementById('prediction-confidence').textContent = 
                `${Math.round(prediction.confidence * 100)}%`;
            
            // Update main prediction display
            const nextPredBox = document.getElementById('next-prediction');
            
            // Set emoji and color based on prediction
            let emoji, color, bgColor, confidenceColor;
            switch(prediction.prediction) {
                case 'LOW':
                    emoji = 'üëá';
                    color = '#28a745';
                    bgColor = '#d4edda';
                    confidenceColor = '#20c997';
                    break;
                case 'MIDDLE':
                    emoji = 'üéØ';
                    color = '#ffc107';
                    bgColor = '#fff3cd';
                    confidenceColor = '#ffd54f';
                    break;
                case 'HIGH':
                    emoji = 'üëÜ';
                    color = '#dc3545';
                    bgColor = '#f8d7da';
                    confidenceColor = '#e83e8c';
                    break;
            }
            
            // Update banner color
            const banner = document.getElementById('prediction-banner');
            banner.style.background = `linear-gradient(135deg, ${color}99 0%, ${confidenceColor}99 100%)`;
            
            const confidencePercent = Math.round(prediction.confidence * 100);
            const confidenceWidth = Math.min(confidencePercent, 100);
            
            nextPredBox.innerHTML = `
                <div class="prediction-main" style="color: ${color};">
                    <span class="prediction-icon">${emoji}</span>
                    <span>${prediction.prediction}</span>
                </div>
                <div class="prediction-confidence" style="color: ${confidenceColor};">
                    ${confidencePercent}% Confidence
                    <div style="margin-top: 10px; width: 300px; height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden; margin: 10px auto;">
                        <div style="width: ${confidenceWidth}%; height: 100%; background: ${confidenceColor}; border-radius: 5px; transition: width 1s ease;"></div>
                    </div>
                </div>
                <div class="prediction-reason">
                    ${prediction.reason || 'Based on 72-hour pattern analysis and AI learning'}
                </div>
            `;
        }

        function updateProbabilityBars(probabilities) {
            const lowProb = Math.round(probabilities.LOW * 100);
            const middleProb = Math.round(probabilities.MIDDLE * 100);
            const highProb = Math.round(probabilities.HIGH * 100);
            
            // Update bar heights with animation
            document.getElementById('low-bar').style.height = `${lowProb}%`;
            document.getElementById('middle-bar').style.height = `${middleProb}%`;
            document.getElementById('high-bar').style.height = `${highProb}%`;
            
            // Update values
            document.getElementById('low-value').textContent = `${lowProb}%`;
            document.getElementById('middle-value').textContent = `${middleProb}%`;
            document.getElementById('high-value').textContent = `${highProb}%`;
        }

        // Load latest game
        async function loadLatestGame() {
            try {
                const response = await fetch('/api/get-games?per_page=1');
                const data = await response.json();
                
                if (data.success && data.games.length > 0) {
                    displayLatestGame(data.games[0]);
                }
            } catch (error) {
                console.error('Error loading latest game:', error);
            }
        }

        // Display latest game
        function displayLatestGame(game) {
            const latestGameDiv = document.getElementById('latest-game');
            
            // Determine badge class based on total
            let badgeClass = 'badge-warning';
            if (game.total <= 9) badgeClass = 'badge-success';
            if (game.total >= 12) badgeClass = 'badge-danger';
            
            // Determine category
            let category = '';
            if (game.total <= 9) category = 'LOW';
            else if (game.total <= 11) category = 'MIDDLE';
            else category = 'HIGH';
            
            latestGameDiv.innerHTML = `
                <div class="game-header">
                    <div class="game-title">üéÆ Game: ${game.game_id.substring(0, 10)}...</div>
                    <div class="game-time">‚è∞ ${game.time} | üìÖ ${game.date}</div>
                </div>
                
                <div class="dice-display">
                    <div class="dice">${game.dice_icons.charAt(0)}</div>
                    <div class="dice">${game.dice_icons.charAt(1)}</div>
                    <div class="dice">${game.dice_icons.charAt(2)}</div>
                </div>
                
                <div class="total-display">
                    <div class="total-label">Total Sum of Dice</div>
                    <div class="total-value">${game.total}</div>
                    <span class="badge ${badgeClass}">${category} | ${game.dice1} + ${game.dice2} + ${game.dice3}</span>
                </div>
                
                <div style="text-align: center; margin-top: 20px; display: flex; justify-content: center; gap: 30px;">
                    <div style="color: #666; font-size: 1rem; background: white; padding: 10px 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        üí∞ Amount: <strong style="color: #28a745;">$${game.total_amount.toLocaleString()}</strong>
                    </div>
                    <div style="color: #666; font-size: 1rem; background: white; padding: 10px 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                        üë• Winners: <strong style="color: #667eea;">${game.total_winners}</strong>
                    </div>
                </div>
            `;
        }

        // Load games with AI predictions
        async function loadGamesWithPredictions() {
            try {
                showLoading('games-table', 'Loading AI prediction history...');
                
                const response = await fetch(`/api/games-with-predictions?page=${currentPage}&per_page=${gamesPerPage}`);
                const data = await response.json();
                
                if (data.success) {
                    displayPredictionHistory(data.games);
                    updatePaginationWithData(data);
                    
                    showNotification(`‚úÖ Loaded ${data.games.length} games with AI predictions`);
                } else {
                    showError('games-table', 'Failed to load prediction history');
                }
            } catch (error) {
                console.error('Error loading prediction history:', error);
                showError('games-table', 'Error loading AI prediction data');
            }
        }

        // Display prediction history table
        function displayPredictionHistory(games) {
            const gamesTable = document.getElementById('games-table');
            
            if (games.length === 0) {
                gamesTable.innerHTML = '<div class="error">No games with AI predictions found</div>';
                return;
            }
            
            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th style="width: 100px;">‚è∞ Time</th>
                            <th style="width: 120px;">üé≤ Dice</th>
                            <th style="width: 100px;">üìä Total</th>
                            <th style="width: 150px;">ü§ñ AI Prediction</th>
                            <th style="width: 120px;">üéØ Result</th>
                            <th style="width: 120px;">üìä Confidence</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            games.forEach((game, index) => {
                const hasPrediction = game.ai_prediction !== null && game.ai_prediction !== undefined;
                const actualCategory = game.actual_category || getCategory(game.total);
                
                // Determine category colors
                const categoryClass = `category-${actualCategory.toLowerCase()}`;
                
                // Determine result styling
                let resultHTML = '';
                let rowClass = '';
                
                if (hasPrediction) {
                    const isCorrect = game.prediction_correct;
                    const confidence = Math.round((game.ai_confidence || 0) * 100);
                    
                    // Confidence indicator
                    let confidenceClass = 'confidence-low';
                    if (confidence >= 70) confidenceClass = 'confidence-high';
                    else if (confidence >= 50) confidenceClass = 'confidence-medium';
                    
                    // Result indicator
                    if (game.prediction_evaluated) {
                        if (isCorrect) {
                            resultHTML = `
                                <div class="prediction-result">
                                    <span class="result-correct">‚úÖ Correct</span>
                                </div>
                            `;
                            rowClass = 'correct-prediction';
                        } else {
                            resultHTML = `
                                <div class="prediction-result">
                                    <span class="result-incorrect">‚ùå Incorrect</span>
                                </div>
                            `;
                            rowClass = 'incorrect-prediction';
                        }
                    } else {
                        resultHTML = `
                            <div class="prediction-result">
                                <span class="result-pending">‚è≥ Pending</span>
                            </div>
                        `;
                    }
                    
                    // Prediction row
                    tableHTML += `
                        <tr class="${rowClass}">
                            <td>
                                <div style="font-weight: 600;">${game.time}</div>
                                <div style="font-size: 0.8rem; color: #6c757d;">${game.date}</div>
                            </td>
                            <td>
                                <div style="font-size: 1.8rem; margin-bottom: 2px;">${game.dice_icons}</div>
                                <div style="font-size: 0.8rem; color: #495057;">
                                    ${game.dice1}, ${game.dice2}, ${game.dice3}
                                </div>
                            </td>
                            <td>
                                <div style="font-size: 1.8rem; font-weight: bold; text-align: center; color: #495057;">
                                    ${game.total}
                                </div>
                                <div style="text-align: center; margin-top: 2px;">
                                    <span class="category-badge ${categoryClass}">
                                        ${actualCategory}
                                    </span>
                                </div>
                            </td>
                            <td>
                                <div style="font-size: 1.1rem; font-weight: 600; color: #495057; margin-bottom: 4px;">
                                    ${game.ai_prediction}
                                </div>
                                <div style="font-size: 0.8rem; color: #6c757d; line-height: 1.2;">
                                    ${game.ai_reason ? game.ai_reason.substring(0, 50) + '...' : 'AI analysis'}
                                </div>
                            </td>
                            <td>
                                ${resultHTML}
                                ${hasPrediction && game.prediction_evaluated ? `
                                    <div style="font-size: 0.8rem; color: #6c757d; text-align: center; margin-top: 4px;">
                                        Actual: ${actualCategory}
                                    </div>
                                ` : ''}
                            </td>
                            <td>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.3rem; font-weight: bold; color: #667eea; margin-bottom: 4px;">
                                        ${confidence}%
                                    </div>
                                    <div class="confidence-indicator">
                                        <div class="confidence-fill ${confidenceClass}" style="width: ${confidence}%"></div>
                                    </div>
                                    <div style="font-size: 0.8rem; color: #6c757d; margin-top: 4px;">
                                        Confidence
                                    </div>
                                </div>
                            </td>
                        </tr>
                    `;
                } else {
                    // No prediction available
                    tableHTML += `
                        <tr>
                            <td>
                                <div style="font-weight: 600;">${game.time}</div>
                                <div style="font-size: 0.8rem; color: #6c757d;">${game.date}</div>
                            </td>
                            <td>
                                <div style="font-size: 1.8rem; margin-bottom: 2px;">${game.dice_icons}</div>
                                <div style="font-size: 0.8rem; color: #495057;">
                                    ${game.dice1}, ${game.dice2}, ${game.dice3}
                                </div>
                            </td>
                            <td>
                                <div style="font-size: 1.8rem; font-weight: bold; text-align: center; color: #495057;">
                                    ${game.total}
                                </div>
                                <div style="text-align: center; margin-top: 2px;">
                                    <span class="category-badge ${categoryClass}">
                                        ${actualCategory}
                                    </span>
                                </div>
                            </td>
                            <td>
                                <div style="color: #6c757d; font-style: italic; text-align: center; padding: 10px;">
                                    No AI prediction
                                </div>
                            </td>
                            <td>
                                <div style="color: #6c757d; text-align: center;">
                                    N/A
                                </div>
                            </td>
                            <td>
                                <div style="color: #6c757d; text-align: center;">
                                    N/A
                                </div>
                            </td>
                        </tr>
                    `;
                }
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            gamesTable.innerHTML = tableHTML;
        }

        // Helper function to get category
        function getCategory(total) {
            if (total <= 9) return 'LOW';
            if (total <= 11) return 'MIDDLE';
            return 'HIGH';
        }

        // Update pagination with data
        function updatePaginationWithData(data) {
            totalGames = data.total_games || 0;
            totalPages = data.total_pages || 1;
            
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('total-pages').textContent = totalPages;
            document.getElementById('total-games-count').textContent = totalGames.toLocaleString();
            document.getElementById('total-results').textContent = `${totalGames.toLocaleString()} games`;
            
            const showingStart = Math.min((currentPage - 1) * gamesPerPage + 1, totalGames);
            const showingEnd = Math.min(currentPage * gamesPerPage, data.total_count || 0);
            document.getElementById('showing-start').textContent = showingStart.toLocaleString();
            document.getElementById('showing-end').textContent = showingEnd.toLocaleString();
            
            // Enable/disable buttons
            document.getElementById('prev-btn').disabled = currentPage <= 1;
            document.getElementById('next-btn').disabled = currentPage >= totalPages;
            
            // Update button styles
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            if (currentPage <= 1) {
                prevBtn.style.opacity = '0.5';
                prevBtn.style.cursor = 'not-allowed';
            } else {
                prevBtn.style.opacity = '1';
                prevBtn.style.cursor = 'pointer';
            }
            
            if (currentPage >= totalPages) {
                nextBtn.style.opacity = '0.5';
                nextBtn.style.cursor = 'not-allowed';
            } else {
                nextBtn.style.opacity = '1';
                nextBtn.style.cursor = 'pointer';
            }
        }

        // Load all games (without predictions)
        async function loadAllGames() {
            try {
                showLoading('games-table', 'Loading all games...');
                
                const response = await fetch(`/api/get-games?page=${currentPage}&per_page=${gamesPerPage}`);
                const data = await response.json();
                
                if (data.success) {
                    displayAllGames(data.games);
                    updatePaginationWithAllGames(data);
                    
                    // Hide prediction stats for all games view
                    document.getElementById('prediction-stats-container').style.display = 'none';
                }
            } catch (error) {
                console.error('Error loading all games:', error);
                showError('games-table', 'Error loading games data');
            }
        }

        // Update pagination for all games
        function updatePaginationWithAllGames(data) {
            totalGames = data.total_in_memory || 0;
            totalPages = Math.max(1, Math.ceil(totalGames / gamesPerPage));
            
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('total-pages').textContent = totalPages;
            document.getElementById('total-games-count').textContent = totalGames.toLocaleString();
            document.getElementById('total-results').textContent = `${totalGames.toLocaleString()} games`;
            
            const showingStart = Math.min((currentPage - 1) * gamesPerPage + 1, totalGames);
            const showingEnd = Math.min(currentPage * gamesPerPage, data.total_count || 0);
            document.getElementById('showing-start').textContent = showingStart.toLocaleString();
            document.getElementById('showing-end').textContent = showingEnd.toLocaleString();
            
            // Enable/disable buttons
            document.getElementById('prev-btn').disabled = currentPage <= 1;
            document.getElementById('next-btn').disabled = currentPage >= totalPages;
        }

        // Display all games table
        function displayAllGames(games) {
            const gamesTable = document.getElementById('games-table');
            
            if (games.length === 0) {
                gamesTable.innerHTML = '<div class="error">No games found</div>';
                return;
            }
            
            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>‚è∞ Time</th>
                            <th>üé≤ Dice</th>
                            <th>üìä Total</th>
                            <th>üí∞ Amount</th>
                            <th>üë• Winners</th>
                            <th>üìù Game ID</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            games.forEach((game, index) => {
                const category = getCategory(game.total);
                const categoryClass = `category-${category.toLowerCase()}`;
                
                tableHTML += `
                    <tr>
                        <td>
                            <div style="font-weight: 600;">${game.time}</div>
                            <div style="font-size: 0.9rem; color: #6c757d;">${game.date}</div>
                        </td>
                        <td>
                            <div style="font-size: 2rem; margin-bottom: 5px;">${game.dice_icons}</div>
                            <div style="font-size: 0.9rem;">${game.dice1}, ${game.dice2}, ${game.dice3}</div>
                        </td>
                        <td>
                            <div style="font-size: 2.2rem; font-weight: bold;">${game.total}</div>
                            <div style="text-align: center; margin-top: 5px;">
                                <span class="category-badge ${categoryClass}">
                                    ${category}
                                </span>
                            </td>
                        </td>
                        <td>
                            <div style="font-size: 1.1rem; font-weight: 600; color: #28a745;">
                                $${game.total_amount.toLocaleString()}
                            </div>
                        </td>
                        <td>
                            <div style="font-size: 1.1rem; font-weight: 600; color: #667eea;">
                                ${game.total_winners}
                            </div>
                        </td>
                        <td>
                            <div style="font-size: 0.9rem; color: #6c757d; font-family: monospace;">
                                ${game.game_hash.substring(0, 12)}...
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            gamesTable.innerHTML = tableHTML;
        }

        // Pagination functions
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                if (viewMode === 'predictions') {
                    loadGamesWithPredictions();
                } else {
                    loadAllGames();
                }
                scrollToGamesTable();
            }
        }

        function nextPage() {
            if (currentPage < totalPages) {
                currentPage++;
                if (viewMode === 'predictions') {
                    loadGamesWithPredictions();
                } else {
                    loadAllGames();
                }
                scrollToGamesTable();
            }
        }

        function loadFirstPage() {
            currentPage = 1;
            if (viewMode === 'predictions') {
                loadGamesWithPredictions();
            } else {
                loadAllGames();
            }
            scrollToGamesTable();
            showNotification('Loaded first page');
        }

        // Scroll to games table
        function scrollToGamesTable() {
            const gamesTable = document.querySelector('.games-table-container');
            if (gamesTable) {
                gamesTable.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Scroll to top functionality
        function toggleScrollTopButton() {
            const scrollBtn = document.getElementById('scroll-to-top');
            if (window.scrollY > 300) {
                scrollBtn.style.display = 'flex';
            } else {
                scrollBtn.style.display = 'none';
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Quick check for new games
        async function quickCheck() {
            try {
                const response = await fetch('/api/quick-check');
                const data = await response.json();
                
                if (data.success) {
                    if (data.new_games_count > 0) {
                        showNotification(`üéâ ${data.new_games_count} new games found!`);
                        
                        // Reload latest game
                        loadLatestGame();
                        
                        // Reload prediction table if in prediction mode
                        if (viewMode === 'predictions') {
                            loadGamesWithPredictions();
                        }
                        
                        // Update AI prediction
                        getAIPrediction();
                        
                        // AI stats ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                        loadAIStats();
                    }
                    
                    // Update status
                    loadStatus();
                }
            } catch (error) {
                console.error('Error in quick check:', error);
            }
        }

        // Force refresh
        async function forceRefresh() {
            try {
                const response = await fetch('/api/force-refresh');
                const data = await response.json();
                
                if (data.success) {
                    showNotification(`‚úÖ ${data.message}`);
                    
                    // Reload all data
                    loadStatus();
                    loadStats();
                    loadLatestGame();
                    
                    if (viewMode === 'predictions') {
                        loadGamesWithPredictions();
                    } else {
                        loadAllGames();
                    }
                    
                    loadAIStats();
                    getAIPrediction();
                }
            } catch (error) {
                console.error('Error in force refresh:', error);
                showNotification('Error force refreshing', 'error');
            }
        }

        // Clear filters
        function clearFilters() {
            viewMode = 'predictions';
            currentPage = 1;
            gamesPerPage = 50;
            
            const select = document.getElementById('per-page-select');
            select.value = '50';
            
            const buttons = document.querySelectorAll('.view-btn');
            buttons.forEach((btn, index) => {
                if (index === 0) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            loadGamesWithPredictions();
            showNotification('Filters cleared to default view');
        }

        // Reset AI data
        function resetAIData() {
            if (confirm('Are you sure you want to reset AI data? This will clear prediction history.')) {
                showNotification('AI data reset initiated...', 'warning');
                // In production, call an API endpoint to reset AI
                setTimeout(() => {
                    showNotification('AI data has been reset. Retraining with current data...');
                    getAIPrediction();
                    loadGamesWithPredictions();
                    loadAIStats();
                }, 1500);
            }
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = type === 'error' ? 'error' : 'success';
            notification.innerHTML = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '10000';
            notification.style.maxWidth = '400px';
            notification.style.boxShadow = '0 10px 40px rgba(0,0,0,0.2)';
            notification.style.animation = 'fadeIn 0.3s ease';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeIn 0.3s ease reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Show loading state
        function showLoading(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `<div class="loading">${message}</div>`;
            }
        }

        // Show error state
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `<div class="error">${message}</div>`;
            }
        }

        // Stop auto refresh when page is not visible
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                if (autoRefreshInterval) clearInterval(autoRefreshInterval);
                if (aiStatsInterval) clearInterval(aiStatsInterval);
            } else {
                autoRefreshInterval = setInterval(autoRefresh, 3000);
                aiStatsInterval = setInterval(loadAIStats, 10000);
            }
        });

        // Initialize scroll to top button
        toggleScrollTopButton();
    </script>
</body>
</html>